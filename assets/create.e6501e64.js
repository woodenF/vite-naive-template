import{bk as H,bl as q,bm as V,U as F,S as A,bn as W,R as N,g as O,r as Z,a6 as z,a5 as J}from"./index.fe60ce87.js";function ve(e,n){let{target:t}=e;for(;t;){if(t.dataset&&t.dataset[n]!==void 0)return!0;t=t.parentElement}return!1}function be(e={},n){const t=H({ctrl:!1,command:!1,win:!1,shift:!1,tab:!1}),{keydown:r,keyup:s}=e,f=o=>{switch(o.key){case"Control":t.ctrl=!0;break;case"Meta":t.command=!0,t.win=!0;break;case"Shift":t.shift=!0;break;case"Tab":t.tab=!0;break}r!==void 0&&Object.keys(r).forEach(a=>{if(a!==o.key)return;const u=r[a];if(typeof u=="function")u(o);else{const{stop:c=!1,prevent:k=!1}=u;c&&o.stopPropagation(),k&&o.preventDefault(),u.handler(o)}})},i=o=>{switch(o.key){case"Control":t.ctrl=!1;break;case"Meta":t.command=!1,t.win=!1;break;case"Shift":t.shift=!1;break;case"Tab":t.tab=!1;break}s!==void 0&&Object.keys(s).forEach(a=>{if(a!==o.key)return;const u=s[a];if(typeof u=="function")u(o);else{const{stop:c=!1,prevent:k=!1}=u;c&&o.stopPropagation(),k&&o.preventDefault(),u.handler(o)}})},h=()=>{(n===void 0||n.value)&&(N("keydown",document,f),N("keyup",document,i)),n!==void 0&&O(n,o=>{o?(N("keydown",document,f),N("keyup",document,i)):(A("keydown",document,f),A("keyup",document,i))})};return q()?(V(h),F(()=>{(n===void 0||n.value)&&(A("keydown",document,f),A("keyup",document,i))})):h(),W(t)}function we(e,n,t){var r;const s=z(e,null);if(s===null)return;const f=(r=J())===null||r===void 0?void 0:r.proxy;O(t,i),i(t.value),F(()=>{i(void 0,t.value)});function i(a,u){const c=s[n];u!==void 0&&h(c,u),a!==void 0&&o(c,a)}function h(a,u){a[u]||(a[u]=[]),a[u].splice(a[u].findIndex(c=>c===f),1)}function o(a,u){a[u]||(a[u]=[]),~a[u].findIndex(c=>c===f)||a[u].push(f)}}function Se(e,n,t){if(!n)return e;const r=Z(e.value);let s=null;return O(e,f=>{s!==null&&window.clearTimeout(s),f===!0?t&&!t.value?r.value=!0:s=window.setTimeout(()=>{r.value=!0},n):r.value=!1}),r}function j(e){return Array.isArray(e)?e:[e]}const T={STOP:"STOP"};function U(e,n){const t=n(e);e.children!==void 0&&t!==T.STOP&&e.children.forEach(r=>U(r,n))}function Q(e,n={}){const{preserveGroup:t=!1}=n,r=[],s=t?i=>{i.isLeaf||(r.push(i.key),f(i.children))}:i=>{i.isLeaf||(i.isGroup||r.push(i.key),f(i.children))};function f(i){i.forEach(s)}return f(e),r}function X(e,n){const{isLeaf:t}=e;return t!==void 0?t:!n(e)}function Y(e){return e.children}function $(e){return e.key}function R(){return!1}function ee(e,n){const{isLeaf:t}=e;return!(t===!1&&!Array.isArray(n(e)))}function te(e){return e.disabled===!0}function ne(e,n){return e.isLeaf===!1&&!Array.isArray(n(e))}function L(e){var n;return e==null?[]:Array.isArray(e)?e:(n=e.checkedKeys)!==null&&n!==void 0?n:[]}function G(e){var n;return e==null||Array.isArray(e)?[]:(n=e.indeterminateKeys)!==null&&n!==void 0?n:[]}function re(e,n){const t=new Set(e);return n.forEach(r=>{t.has(r)||t.add(r)}),Array.from(t)}function ie(e,n){const t=new Set(e);return n.forEach(r=>{t.has(r)&&t.delete(r)}),Array.from(t)}function se(e){return(e==null?void 0:e.type)==="group"}function Ke(e){const n=new Map;return e.forEach((t,r)=>{n.set(t.key,r)}),t=>{var r;return(r=n.get(t))!==null&&r!==void 0?r:null}}class ae extends Error{constructor(){super(),this.message="SubtreeNotLoadedError: checking a subtree whose required nodes are not fully loaded."}}function ue(e,n,t,r){return P(n.concat(e),t,r,!1)}function oe(e,n){const t=new Set;return e.forEach(r=>{const s=n.treeNodeMap.get(r);if(s!==void 0){let f=s.parent;for(;f!==null&&!(f.disabled||t.has(f.key));)t.add(f.key),f=f.parent}}),t}function le(e,n,t,r){const s=P(n,t,r,!1),f=P(e,t,r,!0),i=oe(e,t),h=[];return s.forEach(o=>{(f.has(o)||i.has(o))&&h.push(o)}),h.forEach(o=>s.delete(o)),s}function I(e,n){const{checkedKeys:t,keysToCheck:r,keysToUncheck:s,indeterminateKeys:f,cascade:i,leafOnly:h,checkStrategy:o,allowNotLoaded:a}=e;if(!i)return r!==void 0?{checkedKeys:re(t,r),indeterminateKeys:Array.from(f)}:s!==void 0?{checkedKeys:ie(t,s),indeterminateKeys:Array.from(f)}:{checkedKeys:Array.from(t),indeterminateKeys:Array.from(f)};const{levelTreeNodeMap:u}=n;let c;s!==void 0?c=le(s,t,n,a):r!==void 0?c=ue(r,t,n,a):c=P(t,n,a,!1);const k=o==="parent",C=o==="child"||h,g=c,K=new Set,x=Math.max.apply(null,Array.from(u.keys()));for(let S=x;S>=0;S-=1){const E=S===0,w=u.get(S);for(const l of w){if(l.isLeaf)continue;const{key:d,shallowLoaded:p}=l;if(C&&p&&l.children.forEach(y=>{!y.disabled&&!y.isLeaf&&y.shallowLoaded&&g.has(y.key)&&g.delete(y.key)}),l.disabled||!p)continue;let v=!0,m=!1,b=!0;for(const y of l.children){const _=y.key;if(!y.disabled){if(b&&(b=!1),g.has(_))m=!0;else if(K.has(_)){m=!0,v=!1;break}else if(v=!1,m)break}}v&&!b?(k&&l.children.forEach(y=>{!y.disabled&&g.has(y.key)&&g.delete(y.key)}),g.add(d)):m&&K.add(d),E&&C&&g.has(d)&&g.delete(d)}}return{checkedKeys:Array.from(g),indeterminateKeys:Array.from(K)}}function P(e,n,t,r){const{treeNodeMap:s,getChildren:f}=n,i=new Set,h=new Set(e);return e.forEach(o=>{const a=s.get(o);a!==void 0&&U(a,u=>{if(u.disabled)return T.STOP;const{key:c}=u;if(!i.has(c)&&(i.add(c),h.add(c),ne(u.rawNode,f))){if(r)return T.STOP;if(!t)throw new ae}})}),h}function fe(e,{includeGroup:n=!1,includeSelf:t=!0},r){var s;const f=r.treeNodeMap;let i=e==null?null:(s=f.get(e))!==null&&s!==void 0?s:null;const h={keyPath:[],treeNodePath:[],treeNode:i};if(i!=null&&i.ignored)return h.treeNode=null,h;for(;i;)!i.ignored&&(n||!i.isGroup)&&h.treeNodePath.push(i),i=i.parent;return h.treeNodePath.reverse(),t||h.treeNodePath.pop(),h.keyPath=h.treeNodePath.map(o=>o.key),h}function ce(e){if(e.length===0)return null;const n=e[0];return n.isGroup||n.ignored||n.disabled?n.getNext():n}function de(e,n){const t=e.siblings,r=t.length,{index:s}=e;return n?t[(s+1)%r]:s===t.length-1?null:t[s+1]}function D(e,n,{loop:t=!1,includeDisabled:r=!1}={}){const s=n==="prev"?he:de,f={reverse:n==="prev"};let i=!1,h=null;function o(a){if(a!==null){if(a===e){if(!i)i=!0;else if(!e.disabled&&!e.isGroup){h=e;return}}else if((!a.disabled||r)&&!a.ignored&&!a.isGroup){h=a;return}if(a.isGroup){const u=M(a,f);u!==null?h=u:o(s(a,t))}else{const u=s(a,!1);if(u!==null)o(u);else{const c=ye(a);c!=null&&c.isGroup?o(s(c,t)):t&&o(s(a,!0))}}}}return o(e),h}function he(e,n){const t=e.siblings,r=t.length,{index:s}=e;return n?t[(s-1+r)%r]:s===0?null:t[s-1]}function ye(e){return e.parent}function M(e,n={}){const{reverse:t=!1}=n,{children:r}=e;if(r){const{length:s}=r,f=t?s-1:0,i=t?-1:s,h=t?-1:1;for(let o=f;o!==i;o+=h){const a=r[o];if(!a.disabled&&!a.ignored)if(a.isGroup){const u=M(a,n);if(u!==null)return u}else return a}}return null}const ge={getChild(){return this.ignored?null:M(this)},getParent(){const{parent:e}=this;return e!=null&&e.isGroup?e.getParent():e},getNext(e={}){return D(this,"next",e)},getPrev(e={}){return D(this,"prev",e)}};function pe(e,n){const t=n?new Set(n):void 0,r=[];function s(f){f.forEach(i=>{r.push(i),!(i.isLeaf||!i.children||i.ignored)&&(i.isGroup||t===void 0||t.has(i.key))&&s(i.children)})}return s(e),r}function ke(e,n){const t=e.key;for(;n;){if(n.key===t)return!0;n=n.parent}return!1}function B(e,n,t,r,s,f=null,i=0){const h=[];return e.forEach((o,a)=>{var u;const c=Object.create(r);if(c.rawNode=o,c.siblings=h,c.level=i,c.index=a,c.isFirstChild=a===0,c.isLastChild=a+1===e.length,c.parent=f,!c.ignored){const k=s(o);Array.isArray(k)&&(c.children=B(k,n,t,r,s,c,i+1))}h.push(c),n.set(c.key,c),t.has(i)||t.set(i,[]),(u=t.get(i))===null||u===void 0||u.push(c)}),h}function Ce(e,n={}){var t;const r=new Map,s=new Map,{getDisabled:f=te,getIgnored:i=R,getIsGroup:h=se,getKey:o=$}=n,a=(t=n.getChildren)!==null&&t!==void 0?t:Y,u=n.ignoreEmptyChildren?l=>{const d=a(l);return Array.isArray(d)?d.length?d:null:d}:a,c=Object.assign({get key(){return o(this.rawNode)},get disabled(){return f(this.rawNode)},get isGroup(){return h(this.rawNode)},get isLeaf(){return X(this.rawNode,u)},get shallowLoaded(){return ee(this.rawNode,u)},get ignored(){return i(this.rawNode)},contains(l){return ke(this,l)}},ge),k=B(e,r,s,c,u);function C(l){if(l==null)return null;const d=r.get(l);return d&&!d.isGroup&&!d.ignored?d:null}function g(l){if(l==null)return null;const d=r.get(l);return d&&!d.ignored?d:null}function K(l,d){const p=g(l);return p?p.getPrev(d):null}function x(l,d){const p=g(l);return p?p.getNext(d):null}function S(l){const d=g(l);return d?d.getParent():null}function E(l){const d=g(l);return d?d.getChild():null}const w={treeNodes:k,treeNodeMap:r,levelTreeNodeMap:s,maxLevel:Math.max(...s.keys()),getChildren:u,getFlattenedNodes(l){return pe(k,l)},getNode:C,getPrev:K,getNext:x,getParent:S,getChild:E,getFirstAvailableNode(){return ce(k)},getPath(l,d={}){return fe(l,d,w)},getCheckedKeys(l,d={}){const{cascade:p=!0,leafOnly:v=!1,checkStrategy:m="all",allowNotLoaded:b=!1}=d;return I({checkedKeys:L(l),indeterminateKeys:G(l),cascade:p,leafOnly:v,checkStrategy:m,allowNotLoaded:b},w)},check(l,d,p={}){const{cascade:v=!0,leafOnly:m=!1,checkStrategy:b="all",allowNotLoaded:y=!1}=p;return I({checkedKeys:L(d),indeterminateKeys:G(d),keysToCheck:l==null?[]:j(l),cascade:v,leafOnly:m,checkStrategy:b,allowNotLoaded:y},w)},uncheck(l,d,p={}){const{cascade:v=!0,leafOnly:m=!1,checkStrategy:b="all",allowNotLoaded:y=!1}=p;return I({checkedKeys:L(d),indeterminateKeys:G(d),keysToUncheck:l==null?[]:j(l),cascade:v,leafOnly:m,checkStrategy:b,allowNotLoaded:y},w)},getNonLeafKeys(l={}){return Q(k,l)}};return w}export{we as a,Ce as b,Ke as c,Se as d,ve as h,be as u};

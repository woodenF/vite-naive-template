var A=Object.defineProperty,N=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var S=(e,o,n)=>o in e?A(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,w=(e,o)=>{for(var n in o||(o={}))E.call(o,n)&&S(e,n,o[n]);if(x)for(var n of x(o))U.call(o,n)&&S(e,n,o[n]);return e},k=(e,o)=>N(e,j(o));import{_ as F}from"./views-dashboard88b15392.js";import{f as B,h as I,ae as T,w as V,i as $,g as M,u as C,af as z,d as G,o as D,m as K,n as m,a8 as Q,a9 as W,b as a,p as f,a as q,G as H,V as L,K as R,Q as J,ag as P,ah as X}from"./vendore0826c25.js";function Y(e,o){return new File([e],o,{type:e.type})}function Z(e){return window.URL.createObjectURL(e)}const ee=300,oe={viewMode:1,aspectRatio:1,dragMode:"move"};function ne(e,o={},n={}){const{onShow:t}=e,r=B();let s=null;const l=B(null);function v(){if(!s)return;const i=s.getData();s.getCroppedCanvas(n).toBlob(p=>{if(!p)return;const d=new FileReader;d.readAsDataURL(p),d.onloadend=O=>{var b,y;l.value={base64:(y=(b=O.target)==null?void 0:b.result)!=null?y:"",file:Y(p,`${new Date().getTime()}.${p.type.split("/")[1]}`),cropperData:i}},d.onerror=()=>{l.value={base64:"",cropperData:{}}}})}function h(){const i=C(r);console.log("initCropper",i),i&&(s=new z(i,w(k(w({},oe),{ready(){_()},crop(){_()}}),o)))}I(()=>{T(t)&&t()}),V(r,()=>{h()},{immediate:!0}),$(()=>{s==null||s.destroy()});const _=M(v,ee,{leading:!0,trailing:!0});return{cropperImg:r,cropendResult:l}}const te={class:"bg-black bg-opacity-40 fixed top-0 left-0 right-0 bottom-0 z-[999] flex items-center justify-center"},se={key:0,class:"bg-white overflow-hidden"},ae={class:"flex justify-between items-center p-small text-gray-400 border-b border-solid border-gray-200"},ce=a("div",{class:"font-semibold"}," \u56FE\u7247\u88C1\u526A ",-1),le={class:"px-small py-medium flex"},re=["src"],ie={class:"px-large"},ue=a("div",{class:"flex justify-center text-normal font-semibold text-gray-400 mb-normal"}," \u88C1\u526A\u9884\u89C8 ",-1),de=["src"],fe=["src"],pe={class:"flex justify-end p-small border-t border-solid border-gray-200"},me=R(" \u53D6\u6D88 "),he=R(" \u786E\u8BA4 "),_e=G({name:"Cropper",props:{src:null,onClose:null,afterLeave:null,onSuccess:null,show:{type:Boolean},onShow:null,options:null,canvasOptions:null},setup(e){const o=e,{cropperImg:n,cropendResult:t}=ne({onShow:o.onShow},o.options,o.canvasOptions);function r(){var s,l;!t.value||((s=o.onSuccess)==null||s.call(o,t.value),(l=o.onClose)==null||l.call(o))}return(s,l)=>{const v=F,h=J,_=P;return D(),K(L,{name:"fade",onAfterLeave:e.afterLeave},{default:m(()=>[Q(a("div",te,[f(L,{name:"fade-bottom"},{default:m(()=>{var i,g;return[e.show?(D(),q("div",se,[a("div",ae,[ce,f(v,{name:"cancel",size:"16",onClick:l[0]||(l[0]=p=>{var d;return(d=e.onClose)==null?void 0:d.call(e)})})]),a("div",le,[a("div",null,[a("img",{ref_key:"cropperImg",ref:n,class:"overflow-hidden max-w-[600px]",src:e.src},null,8,re)]),a("div",ie,[ue,a("img",{width:"170",src:(i=C(t))==null?void 0:i.base64,alt:"",class:"mb-normal"},null,8,de),a("img",{width:"170",src:(g=C(t))==null?void 0:g.base64,alt:"",class:"rounded-full"},null,8,fe)])]),a("div",pe,[f(_,null,{default:m(()=>[f(h,{type:"info",onClick:e.onClose},{default:m(()=>[me]),_:1},8,["onClick"]),f(h,{type:"primary",onClick:r},{default:m(()=>[he]),_:1})]),_:1})])])):H("",!0)]}),_:1})],512),[[W,e.show]])]),_:1},8,["onAfterLeave"])}}});let u=null,c=null;function Ce(e){function o(){var t;((t=c==null?void 0:c.component)==null?void 0:t.props).show=!1}function n(t){var r;console.log("==========",typeof t),!(u&&c)&&(u=document.createElement("div"),c=f(_e,{onClose:o,afterLeave:()=>{u&&(document.body.removeChild(u),u=null,c=null)},onShow:()=>{var s;((s=c==null?void 0:c.component)==null?void 0:s.props).show=!0},onSuccess:(r=e.options)==null?void 0:r.onSuccess,show:!1,options:e.options,canvasOptions:e.canvasOptions,src:typeof t=="string"?t:Z(t)}),X(c,u),document.body.appendChild(u))}return{open:n,close:o}}export{Ce as u};
